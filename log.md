# 日志

## 2024/11/13首次提交

**当前已完成图片缩放，拖拉。裁剪掩膜遮盖，改变大小**

**问题：**

1. 图片缩放时需要参考窗口的比例，当前存在部分图片在改变窗口尺寸时，图片大小改变。
   1. 可能是长宽没有同一倍率增长。
2. 掩膜层在窗口尺寸改变时，不会按比例改变大小。
   1. 掩膜层没有铺满情况下，放大，缩小的x,y未改变。
   2. 主要解决在收到resize和move时的操作，且如何区分第一次直接赋值操作。

## 2024/11/13提交

**图像缩放推拉功能改变**

**详细描述：**

1. 改变之前在移动或改变图像大小后，其位置相对于窗口大小改变也会移动。现在改成无论图像是否移动或改变大小，在窗口改变时，恢复默认位置，大小。因为考虑到实际应用情况下，不需要这么复杂。
2. 解决掉图像放大还原后，图像位置出现偏移问题。中心放大缩小偏移好解决，但是移动后再放大缩小偏移未解决。于是在移动后，放大缩小的图像x,y坐标不变。

**问题**

1. 移动后缩放中心坐标偏移问题未解决。只是换了种方式。

## 2024/11/14提交

**掩膜层已完成，只会在windows size改变后恢复默认。在此总结一下一些问题的解决方法**

**详细描述：**

1. 图像层的缩放偏移问题，就是通过计算缩放后的中心点和未缩放前的中心点进行偏移量计算。产生原因应该是按比率缩放产生的小数原因。但是如果在拖动后再改变大小，这个偏移量当前计算不出来，所以解决暂时搁置。
2. 掩膜层的一切问题最好的解决方式是增加针对于要掩膜的图像层添加一个相对坐标系。

**接下来**

1. 针对于裁剪功能添加按钮，选项功能。完成整个裁剪功能再提交。

## 2024/11/19提交

**更改整体架构，以后就不大变了**

**详细描述**

1. mainwindow控制showwidget，showwidget来控制层的显示和功能接口。
2. 新增CLayer抽象类，继承QLabel，其他层是此类派生。
3. showwidget中的图像层是特殊的，自己拦截滚轮+ctrl和右键鼠标事件来控制图像层的缩放和移动。
4. showwidget的其它层(当然现在只有遮盖层)是由showwidget控制的，但是具体操作还是由本身层解决，比如showwidget只获取偏移量，将偏移量传给其它层就不管了。
5. 其它层我想着还是通过固定函数来获取自己层本身的限制层(setRestrictedLayer(const CLayer*)函数)，来限制自己行为。
6. 后续需要添加QWidget限制层的函数，将图像层也改成这种方式。

**接下来**

1. 添加QWidget限制层的函数，将图像层也改成这种固定接口方式。
2. 需要添加暂存功能，也就是在裁剪时，刚开始放在右下角，后面放在鼠标点击时的下面，一个撤销，恢复，对钩按钮，用来退出裁剪功能，恢复默认填充，显示裁剪内容的功能。
3. 然后通过左上角的保存来保存裁剪部分到指定图像。